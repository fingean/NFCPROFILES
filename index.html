<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <title>Contacto</title>
  <style>
    :root{
      --ean-green:#28a745;
      --btn-green: rgba(40,167,69,0.85);
      --btn-green-hover: rgba(40,167,69,1);
      --white:#ffffff;
      --muted:#6b6b6b;
      --card-shadow: 0 8px 20px rgba(0,0,0,0.12);
      --radius:18px;
      --name-font-size:1.15rem;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family: "Arial",sans-serif;background:var(--white);color:#111}

    /* Barra superior - mayor altura para separar del nombre */
    .topbar{
      background:var(--ean-green);
      padding:20px 20px 26px;        /* bottom padding mayor para separar */
      display:flex;
      align-items:center;
      justify-content:space-between;
      position:relative;            /* para poder centrar el titulo absolute */
    }
    .topbar .logo {
      height:62px;
      width:auto;
      display:block;
    }

    /* Texto centrado en la barra */
    .topbar-title {
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      color:var(--white);
      font-weight:800;
      letter-spacing:1px;
      font-size:1.05rem;
      text-transform:uppercase;
      pointer-events:none;
      opacity:0.95;
    }

    /* Contenedor principal */
    .wrapper{
      max-width:420px;
      margin: 18px auto 40px;
      padding: 8px 20px;
    }

    /* Nombre: menos solapado y con mayor padding */
    .name-card{
      margin: -22px auto 18px; /* menor negativo para que no quede pegado */
      width: calc(100% - 40px);
      background: rgba(40,167,69,0.14);
      border-radius: 999px;
      padding: 16px 20px;
      text-align:center;
      font-weight:700;
      font-size:var(--name-font-size);
      color: var(--white);
      box-shadow: 0 6px 16px rgba(0,0,0,0.06);
      line-height:1.25;
    }

    /* Main content (white card) */
    .card{
      background: #fff;
      border-radius: 14px;
      padding: 28px 18px 32px;
      box-shadow: var(--card-shadow);
      text-align:center;
    }

    .photo {
      width:70%;
      max-width:300px;
      aspect-ratio: 3/4;
      margin:0 auto 20px;
      border-radius: 16px;
      overflow:hidden;
      box-shadow: 0 12px 24px rgba(0,0,0,0.08);
      background:#f4f4f4;
    }
    .photo img{width:100%;height:100%;object-fit:cover;display:block}

    .buttons{display:flex;flex-direction:column;gap:14px;margin-top:6px}
    .btn{
      display:flex;align-items:center;justify-content:center;gap:10px;
      background:var(--btn-green);color:var(--white);text-decoration:none;
      padding:12px 14px;border-radius:999px;font-weight:700;font-size:1rem;
      transition:transform .06s ease, background .12s ease; box-shadow: 0 6px 12px rgba(0,0,0,0.06);
    }
    .btn:active{transform:translateY(1px)}
    .btn:hover{background:var(--btn-green-hover)}

    .btn.disabled{
      opacity:0.45;pointer-events:none;background: rgba(40,167,69,0.45);
    }

    .btn .icon{width:20px;height:20px;display:inline-block;fill:#fff}

    .spacer{height:6px}

    @media (max-width:440px){
      .wrapper{padding:12px}
      .topbar{padding:16px 14px 22px}
      .topbar .logo{height:54px}
      .name-card{font-size:1rem;margin-top:-18px}
      .photo{width:78%}
      .btn{font-size:0.98rem;padding:11px}
    }
  </style>
</head>
<body>
  <!-- TOP BAR con logos y titulo centrado -->
  <header class="topbar" role="banner" aria-label="Cabecera">
    <img src="img/logo_ean.png" alt="Logo EAN" class="logo" />
    <div class="topbar-title">Ingeniería</div>
    <img src="img/logo_facultad.png" alt="Logo Facultad" class="logo" />
  </header>

  <main class="wrapper" role="main">
    <!-- Nombre que ahora está más separado de la barra -->
    <div id="nameShell" class="name-card" aria-live="polite">Nombre Por Defecto</div>

    <section class="card" aria-label="Perfil">
      <div class="photo" id="photoContainer">
        <img id="photo" src="img/foto_default.jpg" alt="Foto de perfil" />
      </div>

      <div class="buttons" id="buttonsContainer">
        <a id="linkedinBtn" class="btn" href="#" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M4.98 3.5C3.34 3.5 2 4.84 2 6.5S3.34 9.5 4.98 9.5 7.96 8.16 7.96 6.5 6.62 3.5 4.98 3.5zM2.4 21h5.16V10.5H2.4V21zM9.6 10.5V21h5.16V15.3c0-3.3 4.32-3.6 4.32 0V21H24V13.5c0-6.54-7.44-6.3-9.6-3.09V10.5H9.6z"/></svg>
          LinkedIn
        </a>

        <a id="contactBtn" class="btn disabled" href="#" aria-label="Llamar">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M21 8V7l-3 2-2-1-2 1-2-1-2 1-2-1-2 1-3-2v1l3 2 2-1 2 1 2-1 2 1 2-1 2 1z"/></svg>
          Contacto
        </a>

        <a id="emailBtn" class="btn disabled" href="#" aria-label="Enviar correo">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.89 2 1.99 2H20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5L4 8V6l8 5 8-5v2z"/></svg>
          Email
        </a>
      </div>

      <div class="spacer" aria-hidden="true"></div>
    </section>
  </main>

  <script>
    const DATA_JSON = 'data.json';
    const DEFAULT_ID = 'SH001';

    function safeGet(id){ return document.getElementById(id) || null; }
    function getIdFromUrl(){ const p = new URLSearchParams(window.location.search); return p.get('id') || DEFAULT_ID; }

    function setButtonState(btnEl, href){
      if(!btnEl) return;
      if(href && href.trim() !== '' && href !== '#'){
        btnEl.classList.remove('disabled');
        btnEl.href = href;
      } else {
        btnEl.classList.add('disabled');
        btnEl.href = '#';
      }
    }

    function renderProfile(profile){
      const defaultProfile = { name:'Nombre Por Defecto', photo:'img/foto_default.jpg', linkedin:'#', phone:'', email:'' };
      profile = profile || defaultProfile;

      const nameShell = safeGet('nameShell');
      if(nameShell) nameShell.innerText = profile.name || defaultProfile.name;

      const photoEl = safeGet('photo');
      if(photoEl){
        photoEl.src = profile.photo || defaultProfile.photo;
        photoEl.alt = 'Foto de ' + (profile.name || 'perfil');
      }

      setButtonState(safeGet('linkedinBtn'), profile.linkedin || '#');

      let telHref = '';
      if(profile.phone && profile.phone.trim() !== '') telHref = 'tel:' + profile.phone.replace(/\s+/g,'');
      setButtonState(safeGet('contactBtn'), telHref);

      let mailHref = '';
      if(profile.email && profile.email.trim() !== '') mailHref = 'mailto:' + profile.email;
      setButtonState(safeGet('emailBtn'), mailHref);
    }

    async function loadProfiles(){
      try{
        const resp = await fetch(DATA_JSON + '?_=' + Date.now(), { cache:'no-store' });
        if(!resp.ok) throw new Error('HTTP ' + resp.status);
        const json = await resp.json();
        console.log('data.json ->', json);

        let dataObj = null;
        if(json && json.profiles && typeof json.profiles === 'object'){
          dataObj = json.profiles;
          if(json.default && !dataObj.default) dataObj.default = json.default;
        } else {
          dataObj = json;
        }

        const id = getIdFromUrl();
        const profile = (dataObj && (dataObj[id] || dataObj.default)) ? (dataObj[id] || dataObj.default) : null;
        if(!profile) console.warn('Perfil no encontrado para id=', id);
        renderProfile(profile);
      } catch(e){
        console.error('Error cargando data.json:', e);
        renderProfile(null);
      }
    }

    document.addEventListener('DOMContentLoaded', loadProfiles, false);
  </script>
</body>
</html>


